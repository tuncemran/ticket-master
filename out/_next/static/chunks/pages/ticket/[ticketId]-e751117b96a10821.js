(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[425],{96920:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ticket/[ticketId]",function(){return r(50461)}])},50461:function(t,e,r){"use strict";r.r(e),r.d(e,{__N_SSG:function(){return T}});var n=r(35666),s=r.n(n),i=r(85893),c=r(67294),a=r(1508),o=r(22655),u=r(52256),l=r(52190),d=r(45150),h=r(80967),p=r(22479),f=r(40849),k=(r(73014),r(84540)),v=(r(96215),r(11163));function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t,e,r,n,s,i,c){try{var a=t[i](c),o=a.value}catch(u){return void r(u)}a.done?e(o):Promise.resolve(o).then(n,s)}function j(t){return function(){var e=this,r=arguments;return new Promise((function(n,s){var i=t.apply(e,r);function c(t){m(i,n,s,c,a,"next",t)}function a(t){m(i,n,s,c,a,"throw",t)}c(void 0)}))}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e){return!e||"object"!==C(e)&&"function"!==typeof e?x(t):e}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var C=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function O(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=S(t);if(e){var s=S(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return A(this,r)}}var Z=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(v,t);var e,r,n,c=O(v);function v(){var t;return b(this,v),w(x(t=c.apply(this,arguments)),"state",{userAddress:[],ticketObject:{},ticketAddress:"",dollarRate:0,currentTicket:null,isLoaderActive:!1}),w(x(t),"getTicketStatus",(function(){return void 0===t.state.ticketObject.ticketStatus?null:!0===t.state.ticketObject.ticketStatus[0]?(0,i.jsx)("span",{style:{color:"red"},children:"Deleted"}):!0===t.state.ticketObject.ticketStatus[1]?(0,i.jsx)("span",{style:{color:"yellow"},children:"Deleted"}):!0===t.state.ticketObject.ticketStatus[2]?(0,i.jsx)("span",{style:{color:"green"},children:"Completed"}):!0===t.state.ticketObject.ticketStatus[3]?(0,i.jsx)("span",{style:{color:"blue"},children:"Active"}):void 0})),w(x(t),"getApprovalStatus",(function(){return void 0===t.state.ticketObject.approvalStatus?null:!0===t.state.ticketObject.approvalStatus[0]&&!0===t.state.ticketObject.approvalStatus[1]?(0,i.jsx)("span",{style:{color:"green"},children:"Approved"}):!1===t.state.ticketObject.approvalStatus[0]&&!1===t.state.ticketObject.approvalStatus[1]?(0,i.jsx)("span",{style:{color:"red"},children:"Not Approved"}):!0===t.state.ticketObject.approvalStatus[0]?(0,i.jsx)("span",{style:{color:"yellow"},children:"Owner Approved"}):!0===t.state.ticketObject.approvalStatus[1]?(0,i.jsx)("span",{style:{color:"yellow"},children:"Buyer Approved"}):void 0})),w(x(t),"onSubmitDelete",j(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({isLoaderActive:!0}),t.next=3,this.state.currentTicket.methods.deleteContract().send({from:a.Z.utils.toChecksumAddress(this.state.userAddress),gas:"1000000"});case 3:return t.next=5,this.LifeCycleGetter();case 5:this.setState({isLoaderActive:!1});case 6:case"end":return t.stop()}}),t,this)})).bind(t)).bind(x(t))),w(x(t),"onSubmitReject",j(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({isLoaderActive:!0}),t.next=3,this.state.currentTicket.methods.rejectBuyingRequest().send({from:a.Z.utils.toChecksumAddress(this.state.userAddress),gas:"1000000"});case 3:return t.next=5,this.LifeCycleGetter();case 5:this.setState({isLoaderActive:!1});case 6:case"end":return t.stop()}}),t,this)})).bind(t)).bind(x(t))),w(x(t),"onSubmitApproveOwner",j(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({isLoaderActive:!0}),t.next=3,this.state.currentTicket.methods.ownerApproveBuyingRequest().send({from:a.Z.utils.toChecksumAddress(this.state.userAddress),gas:"1000000"});case 3:return t.next=5,this.LifeCycleGetter();case 5:this.setState({isLoaderActive:!1});case 6:case"end":return t.stop()}}),t,this)})).bind(t)).bind(x(t))),w(x(t),"onSubmitApproveBuyer",j(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({isLoaderActive:!0}),t.next=3,this.state.currentTicket.methods.buyerApproveBuyingRequest().send({from:a.Z.utils.toChecksumAddress(this.state.userAddress),gas:"1000000"});case 3:return t.next=5,this.LifeCycleGetter();case 5:this.setState({isLoaderActive:!1});case 6:case"end":return t.stop()}}),t,this)})).bind(t)).bind(x(t))),w(x(t),"onSubmitCreate",j(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({isLoaderActive:!0}),t.next=3,this.state.currentTicket.methods.createBuyingRequest().send({from:a.Z.utils.toChecksumAddress(this.state.userAddress),value:a.Z.utils.toWei((parseFloat(this.state.ticketObject.ticketPriceInDollars)/this.state.dollarRate).toFixed(4).toString(),"ether")});case 3:return t.next=5,this.LifeCycleGetter();case 5:this.setState({isLoaderActive:!1});case 6:case"end":return t.stop()}}),t,this)})).bind(t)).bind(x(t))),t}return e=v,(r=[{key:"LifeCycleGetter",value:function(){return j(s().mark((function t(){var e,r,n,i,c,u,l,d,h,p,f,k;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.props.router.asPath.replace("/ticket/",""),r=(0,o.Z)(a.Z.utils.toChecksumAddress(e)),t.next=4,r.methods.ticketOwner().call();case 4:return n=t.sent,t.next=7,r.methods.ownerName().call();case 7:return i=t.sent,t.next=10,r.methods.ownerFacebookAccount().call();case 10:return c=t.sent,t.next=13,r.methods.ticketTitle().call();case 13:return u=t.sent,t.next=16,r.methods.ticketDescription().call();case 16:return l=t.sent,t.next=19,r.methods.ticketPriceInDollars().call();case 19:return d=t.sent,t.next=22,r.methods.ticketStatus().call();case 22:return h=t.sent,t.next=25,r.methods.approvalStatus().call();case 25:return p=t.sent,f={ownerName:i,ticketOwner:n,ownerFacebookAccount:c,ticketTitle:u,ticketDescription:l,ticketPriceInDollars:d,ticketStatus:h,approvalStatus:p,ticketAddress:e},t.next=29,fetch("https://min-api.cryptocompare.com/data/price?fsym=BTC&tsyms=USD,JPY,EUR&api_key=d959d81cd1dccd2ebfc13ee40ed8fade13ee19aa51ee6e49d40cdf3748ba6aec").then((function(t){return t.json()})).then((function(t){return t.USD}));case 29:k=t.sent,this.setState({ticketObject:f,ticketAddress:e,dollarRate:k,currentTicket:r});case 31:case"end":return t.stop()}}),t,this)})).bind(this))()}},{key:"UNSAFE_componentWillMount",value:function(){return j(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.LifeCycleGetter();case 2:case"end":return t.stop()}}),t,this)})).bind(this))()}},{key:"componentDidMount",value:function(){return j(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.Z.eth.getAccounts();case 2:e=t.sent,this.setState({userAddress:e[0]});case 4:case"end":return t.stop()}}),t,this)})).bind(this))()}},{key:"ticketComponent",value:function(){return this.state.userAddress===this.state.ticketObject.ticketOwner?this.ticketOwnerComponent():this.ticketBuyerComponent()}},{key:"ticketOwnerComponent",value:function(){var t=this.state.ticketObject;return t==={}?null:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"row",marginTop:40},children:[(0,i.jsxs)(u.Z,{style:{margin:0,float:"left",width:"30%",marginTop:0},children:[(0,i.jsx)(l.Z,{src:"https://react.semantic-ui.com/images/avatar/large/matthew.png",wrapped:!0,ui:!1}),(0,i.jsxs)(u.Z.Content,{children:[(0,i.jsx)(u.Z.Header,{children:t.ticketTitle}),(0,i.jsx)(u.Z.Meta,{children:(0,i.jsxs)("span",{className:"date",children:[t.ownerName," - ",(0,i.jsx)("a",{href:t.ownerFacebookAccount,children:"Check Me On Facebook"})]})}),(0,i.jsx)(u.Z.Description,{children:t.ticketDescription})]}),(0,i.jsx)(u.Z.Content,{extra:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(d.Z,{name:"dollar"}),t.ticketPriceInDollars]})})]}),(0,i.jsx)("div",{style:{width:150},children:(0,i.jsxs)(h.Z.Group,{basic:!0,vertical:!0,style:{width:"100%",height:"100%"},children:[(0,i.jsx)(h.Z,{onClick:this.onSubmitDelete,children:"Delete"}),(0,i.jsx)(h.Z,{onClick:this.onSubmitReject,children:"Reject request"}),(0,i.jsx)(h.Z,{onClick:this.onSubmitApproveOwner,children:"Approve Request"})]})}),(0,i.jsxs)("div",{style:{marginLeft:35,alignSelf:"center"},children:[(0,i.jsxs)("h4",{children:["Ticket status: ",this.getTicketStatus(t.ticketStatus)]}),(0,i.jsx)("br",{}),(0,i.jsxs)("h4",{children:["Approval status: ",this.getApprovalStatus(t.approvalStatus)," "]})]})]})}},{key:"ticketBuyerComponent",value:function(){var t=this.state.ticketObject;return t==={}?null:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"row",marginTop:40},children:[(0,i.jsxs)(u.Z,{style:{margin:0,float:"left",width:"30%",marginTop:0},children:[(0,i.jsx)(l.Z,{src:"https://react.semantic-ui.com/images/avatar/large/matthew.png",wrapped:!0,ui:!1}),(0,i.jsxs)(u.Z.Content,{children:[(0,i.jsx)(u.Z.Header,{children:t.ticketTitle}),(0,i.jsx)(u.Z.Meta,{children:(0,i.jsxs)("span",{className:"date",children:[t.ownerName," - ",(0,i.jsx)("a",{href:t.ownerFacebookAccount,children:"Check Me On Facebook"})]})}),(0,i.jsx)(u.Z.Description,{children:t.ticketDescription})]}),(0,i.jsx)(u.Z.Content,{extra:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(d.Z,{name:"dollar"}),t.ticketPriceInDollars]})})]}),(0,i.jsx)("div",{style:{width:150},children:(0,i.jsxs)(h.Z.Group,{basic:!0,vertical:!0,style:{width:"100%",height:"100%"},children:[(0,i.jsx)(h.Z,{onClick:this.onSubmitCreate,children:"Create"}),(0,i.jsx)(h.Z,{onClick:this.onSubmitApproveBuyer,children:"Approve Request"})]})}),(0,i.jsxs)("div",{style:{marginLeft:35,alignSelf:"center"},children:[(0,i.jsxs)("h4",{children:["Ticket status: ",this.getTicketStatus(t.ticketStatus)]}),(0,i.jsx)("br",{}),(0,i.jsxs)("h4",{children:["Approval status: ",this.getApprovalStatus(t.approvalStatus)," "]})]})]})}},{key:"render",value:function(){return(0,i.jsxs)("div",{children:[(0,i.jsx)(k.Z,{}),this.state.isLoaderActive?(0,i.jsx)(p.Z,{active:!0,inverted:!0,children:(0,i.jsxs)(f.Z,{size:"large",children:["Blockchain needs to confirm this transaction to make this experience safe for everyone! ",(0,i.jsx)("br",{})," ",(0,i.jsx)("br",{})," This usually takes 10-15 seconds. At the meantime please wait and do not refresh the website please..."]})}):null,(0,i.jsxs)(u.Z,{className:"landing-notification-container",children:[(0,i.jsx)(u.Z.Content,{children:(0,i.jsx)(u.Z.Header,{style:{color:"#030e22"},children:"Ticket Details"})}),(0,i.jsxs)(u.Z.Content,{children:[(0,i.jsxs)("div",{children:["The address of this ticket is  ",this.state.ticketAddress,". Do not lose this! As you will not be able to find it in the main page once some one creates a buying request. "]}),(0,i.jsx)("br",{})]})]}),this.ticketComponent()]})}}])&&y(e.prototype,r),n&&y(e,n),v}(c.Component),T=!0;e.default=(0,v.withRouter)(Z)},96215:function(t,e,r){"use strict";var n=r(37018)();n.add("/ticket/:ticketId","/ticket/[ticketId]"),t.exports=n}},function(t){t.O(0,[749,482,606,18,432,774,888,179],(function(){return e=96920,t(t.s=e);var e}));var e=t.O();_N_E=e}]);